{"version":3,"sources":["./src/app/login/login.page.html","./src/app/login/login.module.ts","./src/app/login/login.page.scss","./src/app/login/login.page.ts"],"names":[],"mappings":"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","file":"login-login-module-es2015.js","sourcesContent":["module.exports = \"<ion-header>\\r\\n  <ion-toolbar>\\r\\n    <ion-title>Login</ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content>\\r\\n  <div class=\\\"m1 bg-gray muted\\\">\\r\\n    <mat-card>\\r\\n\\r\\n      <div class=\\\"login-content\\\">\\r\\n\\r\\n        <div class=\\\"mt1\\\">\\r\\n          <img src=\\\"assets/icon/icon.png\\\" width=\\\"10%\\\" height=\\\"10%\\\" class=\\\"block mx-auto\\\">\\r\\n          <h2 class=\\\"logo inline\\\" style=\\\"margin-bottom: 5%\\\">SNATCH</h2>\\r\\n        </div>\\r\\n\\r\\n      </div>\\r\\n\\r\\n      <form class=\\\"login-form\\\">\\r\\n        <mat-form-field class=\\\"full-width\\\">\\r\\n          <input matInput placeholder=\\\"Email or username\\\" type=\\\"email\\\" #email>\\r\\n        </mat-form-field>\\r\\n\\r\\n        <mat-form-field class=\\\"full-width\\\">\\r\\n          <input matInput placeholder=\\\"Password\\\" type=\\\"password\\\" #password>\\r\\n        </mat-form-field>\\r\\n\\r\\n\\r\\n        <button mat-raised-button (click)=\\\"login(email.value, password.value)\\\" class=\\\"mt2 full-width blue-button\\\">Login</button>\\r\\n\\r\\n        <hr>\\r\\n\\r\\n        <p class=\\\"text-center\\\">Forgot your password? <span class=\\\"link-text\\\">Click Here</span></p>\\r\\n\\r\\n\\r\\n      </form>\\r\\n\\r\\n      <hr>\\r\\n\\r\\n      <p class=\\\"text-center\\\">Don't have an account? <span class=\\\"link-text\\\" routerLink=\\\"/signup\\\">Register Now</span></p>\\r\\n\\r\\n\\r\\n\\r\\n    </mat-card>\\r\\n\\r\\n  </div>\\r\\n\\r\\n</ion-content>\\r\\n\"","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { LoginPage } from './login.page';\r\nimport {MatButtonModule, MatCardModule, MatFormFieldModule, MatInputModule} from '@angular/material';\r\nimport {IonicStorageModule} from '@ionic/storage';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: LoginPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n    imports: [\r\n        CommonModule,\r\n        FormsModule,\r\n        IonicModule,\r\n        RouterModule.forChild(routes),\r\n        MatCardModule,\r\n        MatInputModule,\r\n        MatButtonModule,\r\n        MatFormFieldModule\r\n    ],\r\n  declarations: [LoginPage]\r\n})\r\nexport class LoginPageModule {}\r\n","module.exports = \".login-content {\\n  text-align: center;\\n}\\n\\n.facebook-button {\\n  background-color: #3b5998;\\n  color: white;\\n  width: 100%;\\n}\\n\\n.google-button {\\n  background-color: #dd4b39;\\n  color: white;\\n  width: 100%;\\n}\\n\\n.login-form {\\n  margin-top: 10px;\\n}\\n\\n* {\\n  font-family: Karla, sans-serif;\\n}\\n\\n.full-width {\\n  width: 100%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvbG9naW4vRDpcXHNpZGRoYXJ0aFxccmVzZWFyY2hcXHdlYi1wcm9qZWN0c1xcaW9uaWNcXHNuYXRjaC1yaWRlci9zcmNcXGFwcFxcbG9naW5cXGxvZ2luLnBhZ2Uuc2NzcyIsInNyYy9hcHAvbG9naW4vbG9naW4ucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBRUUsa0JBQUE7QUNBRjs7QURJQTtFQUNFLHlCQUFBO0VBQ0EsWUFBQTtFQUNBLFdBQUE7QUNERjs7QURJQTtFQUVFLHlCQUFBO0VBQ0EsWUFBQTtFQUNBLFdBQUE7QUNGRjs7QURLQTtFQUVFLGdCQUFBO0FDSEY7O0FETUE7RUFFRSw4QkFBQTtBQ0pGOztBRE1BO0VBRUUsV0FBQTtBQ0pGIiwiZmlsZSI6InNyYy9hcHAvbG9naW4vbG9naW4ucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmxvZ2luLWNvbnRlbnRcclxue1xyXG4gIHRleHQtYWxpZ246IGNlbnRlcjtcclxuXHJcbn1cclxuXHJcbi5mYWNlYm9vay1idXR0b257XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogIzNiNTk5ODtcclxuICBjb2xvcjogd2hpdGU7XHJcbiAgd2lkdGg6IDEwMCU7XHJcbn1cclxuXHJcbi5nb29nbGUtYnV0dG9uXHJcbntcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZGQ0YjM5O1xyXG4gIGNvbG9yOiB3aGl0ZTtcclxuICB3aWR0aDogMTAwJTtcclxufVxyXG5cclxuLmxvZ2luLWZvcm1cclxue1xyXG4gIG1hcmdpbi10b3A6IDEwcHg7XHJcbn1cclxuXHJcbipcclxue1xyXG4gIGZvbnQtZmFtaWx5OiBLYXJsYSwgc2Fucy1zZXJpZlxyXG59XHJcbi5mdWxsLXdpZHRoXHJcbntcclxuICB3aWR0aDogMTAwJTtcclxufSIsIi5sb2dpbi1jb250ZW50IHtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xufVxuXG4uZmFjZWJvb2stYnV0dG9uIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogIzNiNTk5ODtcbiAgY29sb3I6IHdoaXRlO1xuICB3aWR0aDogMTAwJTtcbn1cblxuLmdvb2dsZS1idXR0b24ge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZGQ0YjM5O1xuICBjb2xvcjogd2hpdGU7XG4gIHdpZHRoOiAxMDAlO1xufVxuXG4ubG9naW4tZm9ybSB7XG4gIG1hcmdpbi10b3A6IDEwcHg7XG59XG5cbioge1xuICBmb250LWZhbWlseTogS2FybGEsIHNhbnMtc2VyaWY7XG59XG5cbi5mdWxsLXdpZHRoIHtcbiAgd2lkdGg6IDEwMCU7XG59Il19 */\"","import { Component, OnInit } from '@angular/core';\r\nimport {Router} from '@angular/router';\r\nimport {HttpClient} from '@angular/common/http';\r\nimport {AppConstants} from '../AppConstants';\r\nimport {ToastController} from '@ionic/angular';\r\nimport {Storage} from '@ionic/storage';\r\nimport {Socket} from 'ngx-socket-io';\r\n\r\n@Component({\r\n  selector: 'app-login',\r\n  templateUrl: './login.page.html',\r\n  styleUrls: ['./login.page.scss'],\r\n})\r\nexport class LoginPage implements OnInit {\r\n\r\n  constructor(private http: HttpClient, private router: Router, private storage: Storage,\r\n              private toast: ToastController, public socket: Socket) { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  login(username: string, pass: string) {\r\n    const body = {\r\n      identifier: username,\r\n      password: pass\r\n    };\r\n\r\n    this.http.post(AppConstants.API.LOGIN, body).subscribe(\r\n        (res) => {\r\n          const result = JSON.parse(JSON.stringify(res));\r\n          console.log('Result', result);\r\n          if (result.user.isRider) {\r\n            this.storage.set('user', result.user);\r\n            this.storage.set('token', result.jwt);\r\n            this.storage.set('login', true);\r\n            AppConstants.user = result.user;\r\n            AppConstants.token = result.jwt;\r\n            AppConstants.IS_LOGGED_IN = true;\r\n            if (navigator) {\r\n              if (AppConstants.IS_LOGGED_IN) {\r\n                this.storage.get('user').then(value => {\r\n                  AppConstants.user = value;\r\n                  console.log(value);\r\n                  this.socket.emit('riders', {action: 'add', rider: AppConstants.user});\r\n                  navigator.geolocation.getCurrentPosition( pos => {\r\n                    AppConstants.lng = +pos.coords.longitude;\r\n                    AppConstants.lat = +pos.coords.latitude;\r\n                    this.updateLocation();\r\n                  });\r\n                });\r\n\r\n              }\r\n\r\n            }\r\n            this.router.navigateByUrl('/');\r\n          } else {\r\n            this.presentToast('You are not a rider!');\r\n          }\r\n\r\n        },\r\n        (error) => {\r\n          console.error(error);\r\n        }\r\n    );\r\n  }\r\n\r\n\r\n  async presentToast(msg) {\r\n    const toast = await this.toast.create({\r\n      message: msg,\r\n      duration: 2000\r\n    });\r\n    toast.present();\r\n  }\r\n\r\n\r\n  updateLocation() {\r\n    this.http.put(AppConstants.API.RIDERS + '/' + AppConstants.user.rider, {lat: AppConstants.lat, lng: AppConstants.lng},\r\n        {headers: { Authorization: `Bearer ${AppConstants.token}`}}).subscribe(\r\n        value => {\r\n          console.log('Update location', value);\r\n          console.log(' location', JSON.parse(JSON.stringify(value)));\r\n          AppConstants.user.rider = value;\r\n          this.socket.emit('riders', {action: 'update', rider: JSON.parse(JSON.stringify(value))});\r\n        },\r\n        error => {\r\n          console.log('An error occurred!', error);\r\n        }\r\n    );\r\n  }\r\n\r\n}\r\n"],"sourceRoot":""}